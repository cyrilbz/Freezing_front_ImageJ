# Freezing_front_ImageJ

To use the R script, you need the Thermimage library: https://github.com/gtatters/Thermimage which relies on ExifTool to work (see the instructions in Thermimage repository).

To use the Image J macro you need MorpholibJ plugin (add "IJPB-plugins" as update site)

# How it works: IJ macro
It opens a .raw temperature data computed by the R script using .seq file generated by FLIR thermal cameras and then:

- It reduces the image stack under study to user defined frame range and region of interest (ROI)
- It computes temperature difference using the first frame of the range as reference, which allows to clearly see the freezing process because of exotherm generation
- It thresholds the previous result (user defined threshold) and clean it using MorphoLibJ, to highlight frozen areas
- To study the freezing dynamic, we then use a user defined line to create a kymograph (or space time plot) of the freezing process along this line
- The macro finally measures the velocity of the ice front speed by using user-defined lines/markers along the kymograph.

This process can be repated as many times as needed, and the results are stored in a table during the whole process.

# How it works: R script
- the content is almost entirely copy/paste from https://github.com/gtatters/Thermimage
- specify in the begining of file: the name of the input file, the begining of the output file, and the step at which you want to export images (for very long videos, R can be out of memory, hence it is useful to skip some images, or chage other lines of code to split a video in several parts)
- just run and let the magic happen.
  
# Usage of the IJ Macro 

Run the script and follows the instructions appearing in the different dialog boxes:
- set up parameters (including threshold for segmentation later) and file name in 1st dialog box
- find a freezing event by scrolling through the slice and add first and last slices as well as a name in 2nd dialog box
- draw a ROi to restrict area to study in 3rd dialog box
- select a line for the creation of a kymograph (4th box). A kymograph is a space-time representation of a dynamic process. Here it can also be seen as a reslice of the image along a line, in z-direction (time). The result is a space (the x-axis is the coordinate along the line) - time (y-axis) plot of the freezing process along the line.
- select a line (5th box) for velocity measurement. You get, in a table, the values in [space unit] / [s], with space unit in pixel or m/cm/... depending on if you set up a scale.
- finally follow the last 2 boxes to keep studying the same kymograph or go to another freezing event (6th box), and then go back to slice range selection or exit the macro (7th box).
